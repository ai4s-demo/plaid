# Backend 功能设计计划

## 设计范围
为 Backend 单元设计详细的业务逻辑，重点是约束求解器和 Agent 交互逻辑。

---

## 设计计划

### 1. 业务逻辑建模
- [ ] 设计约束求解器核心算法
- [ ] 设计 Agent 对话流程和意图识别
- [ ] 设计文件解析逻辑
- [ ] 设计 Picklist 生成逻辑

### 2. 领域模型设计
- [ ] 定义核心实体及其关系
- [ ] 设计数据转换流程
- [ ] 定义枚举和常量

### 3. 业务规则设计
- [ ] 定义 PLAID 约束规则
- [ ] 定义输入验证规则
- [ ] 定义错误处理规则

### 4. 验证设计完整性
- [ ] 检查所有需求覆盖
- [ ] 验证业务规则一致性

---

## 功能设计问题

### Q1: 约束优先级

当所有约束无法同时满足时，哪些约束可以放宽？请排序（1=最重要，不可放宽）：

- 数量精确约束（每个基因的重复数必须正确）1
- 象限平衡约束（四个象限的样品数量均衡）3
- 同类型不相邻约束（同类型对照不在8方向相邻）1
- 对照分散约束（对照之间有间隔）2
- 边缘空白约束（外圈留空）4

[Answer]: 

### Q2: 无解处理

如果约束求解器找不到满足所有约束的解，应该如何处理？

- A) 返回错误，要求用户调整参数
- B) 自动放宽软约束，返回次优解
- C) 返回部分解 + 违反的约束列表，让用户决定
- X) 其他

[Answer]: C

### Q3: Agent 工具调用

Agent 在对话中可以调用哪些工具？（可多选）

- A) 解析源板文件
- B) 生成布局
- C) 验证布局
- D) 生成 Picklist
- E) 解释约束
- F) 以上全部
- X) 其他

[Answer]: F

### Q4: 参数默认值

当用户未指定某些参数时，使用什么默认值？

| 参数 | 您希望的默认值 |
|------|----------------|
| 板类型 | [Answer]: 96|
| 重复数 | [Answer]: 6|
| 边缘空白层数 | [Answer]: 1|
| 分布方式 | [Answer]: 均匀|

### Q5: 孔位命名格式

目标板的孔位命名格式？

- A) 字母+数字，如 A1, B2, C3
- B) 字母+两位数字，如 A01, B02, C03
- C) 纯数字，如 1, 2, 3
- X) 其他

[Answer]: B

### Q6: 多板处理

当样品数量超过单板容量时，如何处理？

- A) 自动分配到多个板
- B) 返回错误，要求用户减少样品
- C) 询问用户是否使用多板
- X) 其他

[Answer]: A

---

请在每个 `[Answer]:` 后填写您的选择，完成后告诉我。
